<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
      <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/flower.png') }}">
    <title>Calendar</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/calendar.css') }}">
</head>

<body>

<div class="layout">

    <!-- SIDEBAR -->
<aside id="sidebar" class="sidebar expanded">

    <button id="toggle-btn" class="toggle-btn">‚ò∞</button>

    <!-- USER INFO -->
        <div class="user-section">
        
        <!-- Avatar con imagen -->
        <div class="avatar">
            <img 
            src="/static/img/flower.png" 
            alt="User avatar"
            >
        </div>

        <!-- Username -->
        <span class="username">{{ session['username'] }}</span>

        </div>



    <!-- MENU -->
    <nav class="menu">
      <a class="menu-item" href="{{ url_for('main.dashboard') }}">
        <span class="item-icon">‚úî</span>
        <span class="item-text">My habits</span>
      </a>

      <a class="menu-item active" href="{{ url_for('main.calendar_view') }}">
        <span class="item-icon">üìÖ</span>
        <span class="item-text">Calendario</span>
      </a>
    </nav>

    <!-- LOGOUT (abajo) -->
    <a class="logout-section" href="{{ url_for('main.logout') }}">
      <span class="logout-icon">‚èª</span>
      <span class="logout-text">Logout</span>
    </a>

</aside>

    <!-- MAIN CONTENT -->
    <main class="calendar-area">

        <!-- Top Title -->
        <h2 class="month-title">{{ month }}</h2>

        <div class="calendar-container">

            <!-- Calendar boxes -->
            <div class="calendar-grid">
                {% for day in month_days %}
                <div class="calendar-day {% if day == today %}today{% endif %}">
                    <span class="day-number">{{ day.day }}</span>

                    <div class="dots">
                        {% for color in dots[day] %}
                        <span class="dot" style="background: {{ color }}"></span>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>

<div class="calendar-right-column">

    <!-- Legend -->
    <div class="legend">
        <p><span class="legend-dot" style="background:#FFE5B4"></span> Physical health</p>
        <p><span class="legend-dot" style="background:#9cc7f5"></span> Mental</p>
        <p><span class="legend-dot" style="background:#76b34e"></span> Social</p>
        <p><span class="legend-dot" style="background:#f48aa2"></span> Hobbies</p>
    </div>

    <!-- Today's habits title -->
    <h3 class="today-title">Today's habits</h3>

    <!-- Today's habits panel -->
    <div class="today-panel">

        <!-- Decorative plant -->
        <img src="/static/img/plant2.png" alt="Plant icon" class="plant-decoration">

        <div class="today-list">
            {% for habit in todays_habits %}
            <form action="{{ url_for('main.toggle_habit', habit_id=habit.id) }}"
                  method="POST" class="habit-row">

                <button class="checkbox
                    {% if habit.completions.filter_by(date=today).first() %}
                        checked
                    {% endif %}">
                </button>

                <span class="habit-text">
                    {{ habit.name }}{% if habit.frequency %} - {{ habit.frequency }}{% endif %}
                </span>
            </form>
            {% endfor %}
        </div>

    </div>

</div>


        </div>

    </main>
</div>

<script>
document.getElementById("toggle-btn").onclick = () => {
  document.getElementById("sidebar").classList.toggle("collapsed");
};
</script>

</body>
</html>
